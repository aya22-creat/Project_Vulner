import { cn } from "@/lib/utils"
import { ShieldCheck, ShieldAlert, ShieldQuestion } from "lucide-react"

interface VulnerabilityBadgeProps {
  hasVulnerabilities: boolean | null | undefined
  className?: string
}

export function VulnerabilityBadge({ hasVulnerabilities, className }: VulnerabilityBadgeProps) {
  if (hasVulnerabilities === null || hasVulnerabilities === undefined) {
    return (
      <span
        className={cn(
          "inline-flex items-center gap-1.5 rounded-full border px-2.5 py-0.5 text-xs font-medium",
          "bg-muted/50 text-muted-foreground border-muted",
          className,
        )}
      >
        <ShieldQuestion className="h-3 w-3" />
        Pending
      </span>
    )
  }

  if (hasVulnerabilities) {
    return (
      <span
        className={cn(
          "inline-flex items-center gap-1.5 rounded-full border px-2.5 py-0.5 text-xs font-medium",
          "bg-destructive/10 text-destructive border-destructive/20",
          className,
        )}
      >
        <ShieldAlert className="h-3 w-3" />
        Vulnerable
      </span>
    )
  }

  return (
    <span
      className={cn(
        "inline-flex items-center gap-1.5 rounded-full border px-2.5 py-0.5 text-xs font-medium",
        "bg-success/10 text-success border-success/20",
        className,
      )}
    >
      <ShieldCheck className="h-3 w-3" />
      Safe
    </span>
  )
}
